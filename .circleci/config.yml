version: 2.1

orbs:
  cypress: cypress-io/cypress@3.3.1 # Используйте актуальную версию Cypress Orb

jobs:
  build:
    docker:
      - image: cypress/browsers:node16.14.2-slim-chrome103-ff102
    steps:
      - checkout
      - cypress/install # Используем команду установки из Cypress Orb
      - run:
          name: Install Cypress explicitly
          command: npm install cypress
      - run:
          name: Verify Cypress installation
          command: npx cypress verify
      - run:
          name: Run Cypress tests with custom command
          command: npm run cypress:run
      - run:
          name: Generate Allure report
          command: npm run report:allure

workflows:
  build_and_test:
    jobs:
      - build
